Get report
---
tags:
  - report
produces:
  - application/json
parameters:
  - name: id
    in: path
    type: integer
    description: scan id
    required: true
responses:
  200:
      description: return report of the scan, if scan is found
      schema:
        properties:
          resource:
            schema:
              id: get_report_ok_resource
              properties:
                id:
                  type: integer
                  description: the report id
                  example: 3
                scan_id:
                  type: integer
                  description: the scan id
                  example: 2
                status:
                  type: string
                  description: the scan status
                  enum: [ 'succeeded', 'failed' ]
                result:
                  type: string
                  description: scan result of the task
                  example: {'nmap': {'command_line': 'nmap -oX - -p 103 192.168.45.149', 'scaninfo': {'tcp': {'method': 'syn', 'services': '103'}}, 'scanstats': {'timestr': 'Mon Dec  7 09:43:15 2020', 'elapsed': '1.52', 'uphosts': '1', 'downhosts': '0', 'totalhosts': '1'}}, 'scan': {'192.168.45.149': {'hostnames': [{'name': 'ubuntu', 'type': 'PTR'}], 'addresses': {'ipv4': '192.168.45.149'}, 'vendor': {}, 'status': {'state': 'up', 'reason': 'localhost-response'}, 'tcp': {103: {'state': 'closed', 'reason': 'reset', 'name': 'gppitnp', 'product': '', 'version': '', 'extrainfo': '', 'conf': '3', 'cpe': ''}}}}}
                result_xml:
                  type: string
                  description: scan xml result of the task
                  example: |
                    <?xml version="1.0" encoding="UTF-8"?>
                    <!DOCTYPE nmaprun>
                    <?xml-stylesheet href="file:///usr/bin/../share/nmap/nmap.xsl" type="text/xsl"?>
                    <!-- Nmap 7.80 scan initiated Wed Dec 30 19:49:35 2020 as: nmap -oX - -p 445,80,8080 192.168.45.1 -->
                    <nmaprun scanner="nmap" args="nmap -oX - -p 445,80,8080 192.168.45.1" start="1609386575" startstr="Wed Dec 30 19:49:35 2020" version="7.80" xmloutputversion="1.04">
                    <scaninfo type="connect" protocol="tcp" numservices="3" services="80,445,8080"/>
                    <verbose level="0"/>
                    <debugging level="0"/>
                    <runstats><finished time="1609386578" timestr="Wed Dec 30 19:49:38 2020" elapsed="3.09" summary="Nmap done at Wed Dec 30 19:49:38 2020; 1 IP address (0 hosts up) scanned in 3.09 seconds" exit="success"/><hosts up="0" down="1" total="1"/>
                    </runstats>
                    </nmaprun>
  400:
      description: scan id is not found
      schema:
        properties:
          resource:
            schema:
              id: get_report_not_found_resource
              properties:
                id:
                  type: integer
                  description: the report id, for the not found scan id, it is 0
                  example: 0
                scan_id:
                  type: integer
                  description: the scan, for the not found scan id, it is 0
                  example: 'null'
                result:
                  type: string
                  description: result of the scan, for the not found scan id, it is null
                  example: 'null'